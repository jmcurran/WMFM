% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/addDerivedVariableToData.R
\name{addDerivedVariableToData}
\alias{addDerivedVariableToData}
\title{Add a derived variable to a data frame from a single assignment line}
\usage{
addDerivedVariableToData(data, txt, allowOverwrite = FALSE)
}
\arguments{
\item{data}{A data frame to modify.}

\item{txt}{A length-1 character string containing one assignment statement.}

\item{allowOverwrite}{Logical; if \code{FALSE} (default), refuse to overwrite an existing column.}
}
\value{
A list with elements:
\itemize{
\item \code{ok}: logical, whether the operation succeeded.
\item \code{msg}: character status message.
\item \code{data}: the updated data frame (if ok), otherwise the original data.
\item \code{name}: the new variable name (if ok).
}
}
\description{
Validates and evaluates a single assignment statement such as
\code{t = 1:nrow(data)} or \code{month = factor(rep(1:12, 12))}.
The RHS is evaluated in a safe environment created by \code{makeSafeEvalEnv()},
so only the data columns plus a small allowlist of base functions are available.
}
\details{
The derived variable is appended to the data frame as a new column.
Scalars are recycled to the number of rows; otherwise the result must have
length \code{nrow(data)}.
}
\examples{
df = data.frame(passengers = 1:144)
res = addDerivedVariableToData(df, "t = 1:nrow(data)")
res$ok
names(res$data)

res2 = addDerivedVariableToData(res$data, "month = factor(rep(1:12, 12))")
table(res2$data$month)

}
